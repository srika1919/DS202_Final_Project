---
title: "Proposal Draft 1"
authors: ["Abhay", "Srika","Neha","Esha","Niharika"]
date: "2023-11-12"
output: html_document
editor_options: 
  markdown: 
    wrap: sentence
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)

```

```{r, child=c('DF1-Employment.Rmd','DF2-Education.Rmd','DF3-Citizenship.Rmd','DF4-Age.Rmd','DF5-Housing.Rmd','DF6-Disabilities.Rmd')}
```

```{r}
#census_api_key(Sys.getenv("CENSUS_API_KEY"), install = TRUE)
```

```{r}
#install.packages("tidycensus")
# Load necessary libraries
library(tidycensus)
library(dplyr)
library(tidyr)

#install.packages("factoextra")
library(factoextra)

#install.packages("ggplot2")
#install.packages("usmap")
#install.packages("maps")
library(ggplot2)
library(usmap)
library(maps)

install.packages("plotly")
```

# Plan for Data Exploration

-   What we have done so far:
    -   Pulled the required ACS 2021 1 year data using a API call
    -   Cleaned the data
    -   Transformed to long format and formatted the table by focusing on the estimates we will be using.
-   We took the ACS 1 year data for the variables:
    -   EMPLOYMENT
    -   Education
    -   Citizenship
    -   Housing
    -   Age
    -   Disabilities
-   We are trying to see the relationship for the various with the employment fo reach state in the US.
-   We are planning to make some visualization like the above drafts which could inform the audience about the factors affecting the employment in various states in the US.

```{r}
merged_data <- df1_wide %>%
  left_join(df2_wide, by = "NAME") %>%
  left_join(df3_wide, by = "NAME")%>%
  left_join(df4_wide, by = "NAME")%>%
  left_join(df5_wide, by = "NAME")%>%
  left_join(df6_wide, by = "NAME")


columns_to_drop <- c('Total.x', 'Total.y', 'Total.x.x', 'Total.y.y')
merged_data <- merged_data[, !(names(merged_data) %in% columns_to_drop)]

colnames(merged_data)
```

### **Title**

**"Socio-Economic Factors Influencing Employment in the United States: A Comprehensive State-by-State Analysis"**

### **Thesis**

This project aims to analyze the impact of various socio-economic factors such as education, age, citizenship status, housing, and disabilities on employment rates across different states in the United States.
Using data from the American Community Survey (ACS) 2021, the study will employ statistical techniques to identify correlations, trends, and patterns, thereby providing insights into the multifaceted nature of employment dynamics in the US.

### **Roadmap and Code for Next Steps**

1.  **Data Exploration and Cleaning**

    -   Continue with data cleaning and handling missing values.

    -   Normalize the data if required for better comparison.

```{r}
#Check for Missing Values
# Checking the number of missing values in each column
summarize_missing_data <- function(data) {
  sapply(data, function(x) sum(is.na(x)))
}

missing_data_summary <- summarize_missing_data(merged_data)
missing_data_summary

```

```{r}
# Handling missing values
handle_missing_values <- function(data) {
  for (col in colnames(data)) {
    if (is.numeric(data[[col]])) {
      data[[col]] <- ifelse(is.na(data[[col]]), median(data[[col]], na.rm = TRUE), data[[col]])
    }
    # Add other conditions if needed for categorical data
  }
  return(data)
}

merged_data <- handle_missing_values(merged_data)

```

```{r}
# Function to normalize only numeric columns
normalize_data <- function(data) {
  for (col in colnames(data)) {
    if (is.numeric(data[[col]])) {
      min_val <- min(data[[col]], na.rm = TRUE)
      max_val <- max(data[[col]], na.rm = TRUE)
      data[[col]] <- (data[[col]] - min_val) / (max_val - min_val)
    }
  }
  return(data)
}

# Apply the normalization function to the merged_data
normalized_data <- normalize_data(merged_data)

```

```{r}
# Create a new dataset with only numeric columns
numeric_data <- normalized_data[sapply(normalized_data, is.numeric)]

# Compute the correlation matrix
correlation_matrix <- cor(numeric_data, use = "complete.obs")

# Use corrplot to visualize
library(corrplot)
corrplot(correlation_matrix, method = "circle")



```

```{r}
# Example: Comparing Education and Employment Rates
ggplot(normalized_data, aes(x = `Education_Bachelors_degree`, y = EmploymentRate)) +
  geom_point() +
  geom_smooth(method = "lm") +

  labs(title = "Relation between Bachelors Degree Holders and Employment Rate", x = "Percentage of Bachelor's Degree Holders", y = "Employment Rate")

  labs(title = "Relation between Bachelors Degree Holders and Employment Rate", x = "Percentage of Bachelors Degree Holders", y = "Employment Rate")


```

```{r}
# Assuming 'merged_data' is your merged dataset with employment and housing information
# Assuming 'plotly' and 'dplyr' are already loaded

# Load the plotly library
library(plotly)

# Create an interactive scatter plot
plotly_scatter <- merged_data %>%
  plot_ly(x = ~`Owner Occupied`, y = ~EmploymentRate, text = ~NAME, mode = "markers") %>%
  add_markers(marker = list(color = "blue", size = 10)) %>%
  layout(title = "Interactive Scatter Plot: Housing vs. Employment",
         xaxis = list(title = "Percentage of Owner-Occupied Housing"),
         yaxis = list(title = "Employment Rate"),
         hovermode = "closest")

# Show the interactive plot
plotly_scatter


```


```{r}
numeric_columns <- sapply(merged_data, is.numeric)
numeric_data <- merged_data[, numeric_columns]

# Create a correlation matrix
correlation_matrix <- cor(numeric_data)

# Round the correlation matrix values
rounded_correlation_matrix <- round(correlation_matrix, digits = 2)

# Print the rounded correlation matrix
print(rounded_correlation_matrix)
# Install the knitr package if not already installed
# install.packages("knitr")

# Load the knitr package
library(knitr)

# Print the rounded correlation matrix as a table
kable(rounded_correlation_matrix)
```

```{r}
# Assuming 'correlation_matrix' is your correlation matrix
employment_correlations <- correlation_matrix["EmploymentRate", ]

# Remove the correlation of EmploymentRate with itself
employment_correlations <- employment_correlations[employment_correlations != 1]

# Convert to data frame for plotting
correlation_df <- data.frame(
  Variable = names(employment_correlations),
  Correlation = employment_correlations
)


```

```{r}
library(ggplot2)

# Plotting
ggplot(correlation_df, aes(x = reorder(Variable, Correlation), y = Correlation)) +
  geom_bar(stat = "identity", fill = "steelblue") +
  coord_flip() +  # Flips the coordinates to make the plot horizontal
  labs(title = "Correlation of Various Factors with Employment Rate",
       x = "Variable",
       y = "Correlation with Employment Rate") +
  theme_minimal() +
  theme(axis.text.x = element_text(angle = 90, vjust = 0.5, hjust = 1))

```

```{r}
library(dplyr)
library(ggplot2)
library(corrplot)

# Calculating correlations
corr_matrix <- cor(rounded_correlation_matrix)

# Plotting the heatmap
corrplot(corr_matrix, method = "color")

```

### **Alignment with Thesis**

1.  **Education and Employment:**

    -   The strong positive correlations between higher education levels (like 'Bachelors Degree' and 'Graduate Professional Degree') and labor force participation align perfectly with your thesis.
        This suggests that higher educational attainment is a critical socio-economic factor influencing employment rates.

2.  **Age Dynamics in Employment:**

    -   The varied correlations across different age brackets ('Age_under_18' through 'Age_over_64') with labor force variables reflect the complex impact of age on employment.
        This is in line with your aim to explore how different age demographics influence employment rates across states.

3.  **Citizenship and Employment Rates:**

    -   The correlation data includes 'U.S.
        Citizen' and 'Not a U.S.
        Citizen', indicating the significant role of citizenship status in employment dynamics, as your thesis proposes to investigate.

4.  **Housing Status:**

    -   The correlations between 'Owner Occupied' and 'Renter Occupied' with labor force and educational variables suggest that housing status might be an important socio-economic factor affecting employment, which aligns with the scope of your study.

5.  **Impact of Disabilities on Employment:**

    -   The relationship between 'DisabilityRate' and employment-related variables ('EmploymentRate', 'UnemploymentRate', 'NotInLaborForceRate') aligns with your project's aim to understand how disabilities influence employment rates.

### **Project-Specific Conclusions**

-   **Educational Attainment as a Driving Force:**

    -   The data suggests that in the U.S., states with higher levels of educational attainment might see higher employment rates, supporting the idea that investment in education could be key to boosting employment.

-   **Age-Related Employment Trends:**

    -   The study could reveal how employment trends vary with age across different states, highlighting the need for age-specific economic and workforce development strategies.

-   **Role of Citizenship in Workforce Participation:**

    -   The correlations indicate that citizenship status can significantly impact employment, suggesting a potential area of policy focus for improving workforce integration.

-   **Housing as an Indicator of Employment Status:**

    -   The link between housing status and employment might offer insights into how housing security or instability impacts employment opportunities in different states.

-   **Disabilities and Labor Force Inclusion:**

    -   The negative correlation between disability rates and employment rates underlines the challenges faced by individuals with disabilities in the labor market, suggesting a need for more inclusive employment policies.

Overall, your analysis using ACS 2021 data is poised to offer comprehensive insights into how various socio-economic factors affect employment rates across the United States, in line with your project's thesis.
This can inform policymakers and stakeholders in developing targeted strategies to enhance employment opportunities for diverse populations in different states.

```{r}
library(ggplot2)
library(dplyr)
library(tidyr)
library(viridis)

# Assuming your data is already loaded into a dataframe named your_data_frame
# If not, load your data like this:
# your_data_frame <- read.csv("path_to_your_data.csv")

X_variable <- "Employed"
Y_variables <- c("Education_Bachelors_degree", "Education_Graduate_professional degree", "Education_Below_9th grade", "Education_High_school_graduate")

# Convert data from wide to long format for easier plotting
long_data <- merged_data %>%
  select(all_of(c(X_variable, Y_variables))) %>%
  gather(key = "variable", value = "value", -all_of(X_variable))

# Create the scatter plot
plot <- ggplot(long_data, aes_string(x = X_variable, y = "value", color = "variable")) +
  geom_point() +
  scale_color_viridis_d() + # Use a colorful scale
  theme_minimal() + # Minimalist theme
  labs(title = "Scatter Plots of Various Education Levels vs Employed Rate",
       x = "Employed Rate",
       y = "Value") +
  theme(plot.title = element_text(hjust = 0.5), # Center the title
        axis.text.x = element_text(angle = 45, hjust = 1)) # Slant x-axis labels

print(plot)



```
```{r}
# Assuming 'merged_data' is your merged dataset with employment and housing information
# Assuming 'ggplot2' is already loaded

# Create a scatter plot
ggplot(merged_data, aes(x = `Owner Occupied`, y = EmploymentRate)) +
  geom_point() +
  geom_smooth(method = "lm") +
  labs(title = "Correlation between Owner-Occupied Housing and Employment Rate",
       x = "Percentage of Owner-Occupied Housing",
       y = "Employment Rate") +
  theme_minimal()

```
```{r}
library(ggplot2)
library(dplyr)
library(tidyr)
library(viridis)

# Assuming your data is already loaded into a dataframe named your_data_frame
# If not, load your data like this:
# your_data_frame <- read.csv("path_to_your_data.csv")

X_variable <- "Unemployed"
Y_variables <- c("Age_18_to_24", "Age_25_to_34", "Age_45_to_54", "Age_55_to_64")

# Convert data from wide to long format for easier plotting
long_data <- merged_data %>%
  select(all_of(c(X_variable, Y_variables))) %>%
  gather(key = "variable", value = "value", -all_of(X_variable))

# Create the scatter plot
plot <- ggplot(long_data, aes_string(x = X_variable, y = "value", color = "variable")) +
  geom_point() +
  scale_color_viridis_d() + # Use a colorful scale
  theme_minimal() + # Minimalist theme
  labs(title = "Scatter Plots of Various Education Levels vs Employed Rate",
       x = "Number of Unemployed",
       y = "Value") +
  theme(plot.title = element_text(hjust = 0.5), # Center the title
        axis.text.x = element_text(angle = 45, hjust = 1)) # Slant x-axis labels

print(plot)

```

