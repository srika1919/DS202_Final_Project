---
title: "DF6-Disabilities"
author: "Abhay Prasanna Rao"
date: "2023-12-02"
output: html_document
---

```{r setup_disabilities, include=FALSE}
knitr::opts_chunk$set(echo = FALSE)
```


```{r}
#install.packages("tidycensus")
# Load necessary libraries
library(tidycensus)
library(dplyr)
library(tidyr)

#install.packages("factoextra")
library(factoextra)

#install.packages("ggplot2")
#install.packages("usmap")
#install.packages("maps")
library(ggplot2)
library(usmap)
library(maps)
```


## DF6 - Disabilities

```{r}
#Abhay
#Disabilities - K201803
# Get ACS data for the Disabilities dataset
df6 <- get_acs(geography = "state", 
               table = "K201803", 
               year = 2021, 
               survey = "acs1-year", 
               cache_table = TRUE)

# Assuming the variables_df6 mapping is similar to variables_df1 but for the Disabilities table
# You need to create variables_df6 with the correct variable codes and labels for the Disabilities data
variables_df6 <- data.frame(
  variable = c("K201803_001", "K201803_002", "K201803_003", "K201803_004", "K201803_005", "K201803_006", "K201803_007","K201803_008","K201803_009"),
  label = c("Total_people", "Total With Disabilities", 
            "Hearing", "Vision difficulty", 
            "cognative", "ambulatory difficulty", 
            "Self-care difficulty","Independent living difficulty","No Disability")
)

# Join your data with the variable labels to get the descriptive names
df6_labeled <- df6 %>%
  left_join(variables_df6, by = "variable")

# Reshape the data so that state names are rows and variable labels are columns
df6_wide <- df6_labeled %>%
  pivot_wider(names_from = label, values_from = estimate, id_cols = NAME)
df6_wide

# df6_wide now has states as rows and the descriptive variable labels as columns

```

```{r}
# Calculate percentages
df6_wide <- df6_wide %>%
  mutate(DisabilityRate = `Total With Disabilities` / `Total_people` * 100)

# Plotting with ggplot2
library(ggplot2)

ggplot(df6_wide, aes(x = reorder(NAME, -DisabilityRate), y = DisabilityRate)) +
  geom_bar(stat = "identity", fill = "steelblue") +
  labs(x = "State", y = "Disability Rate (%)", title = "Disability Rates by State") +
  theme_minimal() +
  theme(axis.text.x = element_text(angle = 90, vjust = 0.5, hjust=1))

```
In the bar chart titled "Disability Rates by State," I notice a striking range of disability rates across the U.S. states and territories. Puerto Rico has the highest rate, over 20%, which is significantly higher than any state, while states such as West Virginia, Mississippi, and Alabama also have high rates, each above 15%. In stark contrast, Utah, New Jersey, California, and the District of Columbia are at the lower end of the spectrum, with rates around or below 10%. This variation suggests that factors like healthcare access, occupation-related risks, and demographic differences could play a role in these rates. From a policy standpoint, it seems crucial that states with higher disability rates may need to prioritize services and support systems for disabled individuals. However, I'm aware that the chart doesn't break down the type or severity of disabilities, which would be essential for a more nuanced understanding and effective policy-making.

```{r}
# Select only the disability-related columns for correlation
disability_data <- df6_wide %>%
  select(`Hearing`, `Vision difficulty`, `cognative`, `ambulatory difficulty`, `Self-care difficulty`, `Independent living difficulty`)

# Compute correlation matrix
correlation_matrix <- cor(disability_data, use = "complete.obs")  # use = "complete.obs" handles missing values

# Check if corrplot is installed; if not, install it
if (!require(corrplot)) install.packages("corrplot")

library(corrplot)
corrplot(correlation_matrix, method = "circle")


```

```{r}
# Comparative analysis of disabilities within a state (example: Iowa)
iowa_data <- df6_wide %>%
  filter(NAME == "Iowa") %>%
 select(`Hearing`, `Vision difficulty`, `cognative`, `ambulatory difficulty`, `Self-care difficulty`, `Independent living difficulty`)

# Plotting the data for Iowa
barplot(as.matrix(iowa_data), beside = TRUE, legend.text = TRUE, args.legend = list(x = "topright"))

```

The bar chart presents a comparison of different types of disabilities among residents of Iowa, with 'Ambulatory difficulty' being the most prevalent. This suggests that mobility impairments are a significant challenge for a large number of Iowans. 'Independent living difficulty' also represents a substantial portion, indicating that many individuals may struggle with daily activities without assistance. Interestingly, 'Vision difficulty' is the least common disability, which may reflect effective preventive care or accessibility to vision correction. 'Hearing' and 'Cognitive' disabilities fall in the middle range, signifying that while they are less common than mobility and independent living issues, they still affect a considerable number of people. This gives us a indepth analysis for each specific state. Similarly we can find for other states and dive deeper into the analysis.




------------------------------------------------------------------------
